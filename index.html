<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸ”¥ Ø§Ø­Ø±Ø¬Ù†ÙŠ Ù„Ùˆ ØªÙ‚Ø¯Ø± - Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† ğŸ‡¹ğŸ‡³</title>
    <style>
      body {
        font-family: "Cairo", sans-serif;
        background: linear-gradient(-45deg, #ff758c, #ff7eb3, #ffc3a0, #ff9a9e);
        background-size: 400% 400%;
        animation: gradientBG 15s ease infinite;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
      }
      @keyframes gradientBG {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 20px;
        text-align: center;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        max-width: 500px;
        width: 90%;
      }
      h1 {
        color: #ff4e50;
      }
      button {
        padding: 15px 25px;
        margin: 10px;
        border: none;
        border-radius: 50px;
        font-size: 18px;
        cursor: pointer;
        transition: transform 0.2s;
      }
      button:active {
        transform: scale(0.95);
      }
      .glow {
        box-shadow: 0 0 20px 5px #4caf50 !important;
        transition: 0.5s;
      }
      .room,
      .question,
      .challenge,
      .score,
      .current-player {
        margin: 15px 0;
        font-weight: bold;
      }
    </style>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff4e50">
    
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker.js').then(function() {
          console.log('Service Worker Registered');
        });
      }
    </script>    
  </head>
  <body>
    <div class="container">
      <h1>ğŸ”¥ Ø§Ø­Ø±Ø¬Ù†ÙŠ Ù„Ùˆ ØªÙ‚Ø¯Ø± ğŸ‡¹ğŸ‡³</h1>
      <div class="room">
        Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ØºØ±ÙØ©: <input type="text" id="roomId" />
        <button onclick="connectWS()">Ø¯Ø®ÙˆÙ„</button>
      </div>
      <div id="game" style="display: none">
        <div class="current-player" id="currentPlayer">Ø§Ù„Ù„Ø§Ø¹Ø¨ 1 ğŸ¯</div>
        <div class="question" id="question">Ø¥Ø¶ØºØ· Ø¹Ù„Ù‰ Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯!</div>
        <button onclick="sendNewQuestion()">ğŸ² Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</button>
        <button onclick="sendAddPoint()">â¤ï¸ Ø£Ø¬Ø§ÙˆØ¨</button>
        <button onclick="sendChallenge()">ğŸ¯ ØªØ­Ø¯ÙŠ</button>
        <div class="challenge" id="challenge"></div>
        <div class="score" id="score">Ù†Ù‚Ø§Ø·: 0</div>
      </div>
    </div>
    <script>
      let ws;
      let score = 0;
      const questions = [
        "Ù…Ø§ Ù‡Ùˆ Ø£ÙƒÙ„Ùƒ Ø§Ù„Ù…ÙØ¶Ù„ØŸ",
        "Ù‡Ù„ Ø³Ø¨Ù‚ ÙˆÙƒØ°Ø¨Øª Ø¹Ù„ÙŠØŸ",
        "Ø£ÙƒØ«Ø± Ø¹Ø§Ø¯Ø© ØªØ²Ø¹Ø¬Ùƒ ÙÙŠÙ†ÙŠØŸ",
        "Ø£ÙƒØ«Ø± Ù…ÙˆÙ‚Ù Ù…Ø­Ø±Ø¬ Ø¨ÙŠÙ†Ù†Ø§ØŸ",
        "Ù„Ùˆ ØªÙ‚Ø¯Ø± ØªØ­Ø°Ù Ù…ÙˆÙ‚Ù Ù…Ù† Ø¹Ù„Ø§Ù‚ØªÙ†Ø§ØŒ Ø£ÙŠ Ù…ÙˆÙ‚ÙØŸ",
        "Ù…Ø§ Ø£ÙƒØ«Ø± Ø´ÙŠØ¡ ØªÙƒØ±Ù‡Ù‡ ÙÙŠÙŠØŸ",
        "Ù‡Ù„ Ø£Ø¹Ø¬Ø¨Øª ÙŠÙˆÙ…Ø§Ù‹ Ø¨Ø´Ø®Øµ ØºÙŠØ±ÙŠØŸ",
        "Ø£Ø­Ø±Ø¬ Ø´ÙŠØ¡ ØµØ§Ø± Ù„Ùƒ Ù…Ø¹Ù†Ø§ØŸ",
      ];
      const challenges = [
        "ØºÙ†ÙŠ Ø£ØºÙ†ÙŠØ© Ø­Ø¨ ğŸ¤",
        "Ø³ÙŠÙ„ÙÙŠ Ù…Ø¬Ù†ÙˆÙ† ğŸ¤ª",
        "Ù‚Ù„ Ø³Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ù… ØªØ®Ø¨Ø±Ù†ÙŠ Ø¨Ù‡ Ù…Ù† Ù‚Ø¨Ù„ ğŸ˜³",
      ];

      function connectWS() {
        const roomId = document.getElementById("roomId").value;
        if (!roomId) {
          alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ØºØ±ÙØ©");
          return;
        }
        ws = new WebSocket(`ws://localhost:8000/ws/${roomId}`);

        ws.onopen = () => {
          document.querySelector(".room").style.display = "none";
          document.getElementById("game").style.display = "block";
        };
        ws.onmessage = (event) => {
          handleMessage(event.data);
        };
        ws.onclose = () => alert("ØªÙ… Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±");
        ws.onerror = () => alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±");
      }

      function sendNewQuestion() {
        const q = questions[Math.floor(Math.random() * questions.length)];
        ws.send(JSON.stringify({ type: "question", text: q }));
      }

      function sendChallenge() {
        const c = challenges[Math.floor(Math.random() * challenges.length)];
        ws.send(JSON.stringify({ type: "challenge", text: c }));
      }

      function sendAddPoint() {
        score++;
        document.getElementById("score").innerText = `Ù†Ù‚Ø§Ø·: ${score}`;
        document.getElementById("score").classList.add("glow");
        setTimeout(
          () => document.getElementById("score").classList.remove("glow"),
          500
        );
        ws.send(JSON.stringify({ type: "score", score: score }));
      }

      function handleMessage(data) {
        const msg = JSON.parse(data);
        if (msg.type === "question")
          document.getElementById("question").innerText = msg.text;
        if (msg.type === "challenge")
          document.getElementById("challenge").innerText = msg.text;
        if (msg.type === "score") {
          document.getElementById("score").innerText = `Ù†Ù‚Ø§Ø·: ${msg.score}`;
        }
      }
    </script>
  </body>
</html>
